data ref "ref_a" {
    base = data.ref.ref_b
}

data ref "ref_b" {
    base = data.ref.ref_c
}
data ref "ref_c" {
    base = data.ref.ref_a
}


data plugin_b "data_plugin_b" {
    parameter_z = ["a", "b", "c", "d"]
}

content text "external_block" {
    text = "External block body"
}

section "external_section" {
    title = "External section"

    content text {
        query = ".data.plugin_a.data_plugin_a"
        text = "external_section text {{ .data.plugin_a.data_plugin_a.result }}"
    }
}

document "test-document" {
    title = "test-title"
    data plugin_a "data_plugin_a" {
        parameter_x = 1
        parameter_y = 2
    }

    data ref "ref-name" {
        base = data.plugin_b.data_plugin_b
        new_param = "123"
    }

    content text {
        query = ".data.plugin_a.data_plugin_a"
        text = "The value is {{ .data.plugin_a.data_plugin_a.result }}"
    }

    section {
        content ref {
            base = content.text.external_block
        }

        content table {
            query = ".data.plugin_b.data_plugin_b.result | length"
            text = "The length of the list is {{ .query_result }}"
            columns = ["ColumnA", "ColumnB", "ColumnC"]
        }

        section ref {
            base = section.external_section
        }
    }
}